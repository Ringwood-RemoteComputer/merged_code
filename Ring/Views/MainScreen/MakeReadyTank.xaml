<UserControl x:Class="Ring.Views.MainScreen.MakeReadyTank"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:userControls="clr-namespace:Ring.Views.UserControls"
             xmlns:tankModels="clr-namespace:Ring.Views.UserControls.TankModels"
             xmlns:controls="clr-namespace:Ring.Controls">
    
    <Grid Background="#F5F5F5">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        

        <!-- Main content area -->
        <Grid Grid.Row="0" Margin="24">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1*" />
                <ColumnDefinition Width="1*" />
            </Grid.ColumnDefinitions>

            <!-- Left Card (MRT Image + Tank Data + Batch Progress) -->
            <Border Grid.Column="0" 
                    BorderThickness="1" 
                    BorderBrush="#E0E0E0" 
                    CornerRadius="8" 
                    Margin="0,0,12,0"
                    Background="White"
                    Effect="{StaticResource DropShadowEffect}">
                <Grid Margin="24">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="1*" />
                    </Grid.ColumnDefinitions>
                    
                    <!-- Left Half: MRT Image -->
                    <Border Grid.Column="0" 
                            Margin="0,0,12,0"
                            BorderThickness="1" 
                            BorderBrush="#E0E0E0" 
                            CornerRadius="6"
                            Background="#F8F9FA"
                            Padding="0">
                        <Image Source="{Binding MRTImage}" 
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               Stretch="UniformToFill"
                               RenderOptions.BitmapScalingMode="HighQuality">
                            <Image.RenderTransform>
                                <TranslateTransform X="8" />
                            </Image.RenderTransform>
                        </Image>
                    </Border>
                            
                    <!-- Right Half: Batch Progress (Top) + Tank Data (Bottom) -->
                    <Grid Grid.Column="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        
                        <!-- Top Right: Batch Progress Section -->
                        <Border Grid.Row="0"
                                BorderThickness="1" 
                                BorderBrush="#E0E0E0" 
                                CornerRadius="6" 
                                Margin="0,0,0,16"
                                Background="White">
                            <StackPanel Margin="16">
                                <TextBlock Text="Batch Progress" 
                                           FontWeight="SemiBold" 
                                           FontSize="14" 
                                           HorizontalAlignment="Center" 
                                           Margin="0,0,0,16" 
                                           Foreground="#0078D4" 
                                           LineHeight="18" />
                                
                                <!-- Current Step -->
                                <StackPanel Margin="0,0,0,8">
                                    <TextBlock Text="Current Step:" 
                                               Margin="0,0,0,8"
                                               Foreground="#1E1E1E" 
                                               FontSize="14"
                                               LineHeight="18" />
                                    <TextBlock Text="{Binding CurrentStep}" 
                                               HorizontalAlignment="Left"
                                               Foreground="#1E1E1E" 
                                               FontSize="14"
                                               LineHeight="18" />
                                </StackPanel>
                                
                                <!-- Ingredient Addition Progress -->
                                <StackPanel Margin="0,0,0,8">
                                    <TextBlock Text="Ingredient Addition Progress:" 
                                               Margin="0,0,0,8"
                                               Foreground="#1E1E1E" 
                                               FontSize="14"
                                               LineHeight="18" />
                                    <ProgressBar Value="{Binding IngredientAdditionProgress}" 
                                                 Maximum="100" 
                                                 Height="20" 
                                                 HorizontalAlignment="Stretch" />
                                </StackPanel>
                                
                                <!-- Mix Time Progress -->
                                <StackPanel Margin="0,0,0,8">
                                    <TextBlock Text="Mix Time Progress:" 
                                               Margin="0,0,0,8"
                                               Foreground="#1E1E1E" 
                                               FontSize="14"
                                               LineHeight="18" />
                                    <ProgressBar Value="{Binding MixTimeProgress}" 
                                                 Maximum="100" 
                                                 Height="20" 
                                                 HorizontalAlignment="Stretch" />
                                </StackPanel>
                                
                                <!-- Mix Time Remaining -->
                                <StackPanel Margin="0,0,0,0">
                                    <TextBlock Text="Mix Time Remaining:" 
                                               Margin="0,0,0,8"
                                               Foreground="#1E1E1E" 
                                               FontSize="14"
                                               LineHeight="18" />
                                    <Border BorderThickness="1" 
                                            BorderBrush="#E0E0E0" 
                                            Padding="12,8" 
                                            Background="White"
                                            CornerRadius="4">
                                        <TextBlock Text="{Binding MixTimeRemaining}" 
                                                   HorizontalAlignment="Left"
                                                   Foreground="#1E1E1E" 
                                                   FontSize="14"
                                                   LineHeight="18" />
                                    </Border>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- Bottom Right: Tank Data Section -->
                        <Border Grid.Row="1"
                                BorderThickness="1" 
                                BorderBrush="#E0E0E0" 
                                CornerRadius="6" 
                                Background="White">
                            <StackPanel Margin="16">
                            <TextBlock Text="Tank Data" 
                                       FontWeight="SemiBold" 
                                           FontSize="14" 
                                       HorizontalAlignment="Center" 
                                           Margin="0,0,0,12" 
                                           Foreground="#0078D4" />
                            
                            <!-- Tank Weight -->
                                <StackPanel Margin="0,0,0,8">
                                <TextBlock Text="Tank Weight (lbs):" 
                                           Margin="0,0,0,4"
                                           Foreground="#1E1E1E" 
                                           FontSize="11" />
                                <Border BorderThickness="1" 
                                        BorderBrush="#E0E0E0" 
                                        Padding="8,4" 
                                        Background="White"
                                        CornerRadius="3">
                                    <TextBlock Text="{Binding Weight, StringFormat={}{0:F0} lbs}" 
                                               HorizontalAlignment="Left"
                                               Foreground="#1E1E1E" 
                                               FontSize="13" />
                                </Border>
                            </StackPanel>
                            
                            <!-- Temperature -->
                                <StackPanel Margin="0,0,0,8">
                                <TextBlock Text="Temperature (°F):" 
                                           Margin="0,0,0,4"
                                           Foreground="#1E1E1E" 
                                           FontSize="11" />
                                <Border BorderThickness="1" 
                                        BorderBrush="#E0E0E0" 
                                        Padding="8,4" 
                                        Background="White"
                                        CornerRadius="3">
                                    <TextBlock Text="{Binding Temperature, StringFormat={}{0:F0}°F}" 
                                               HorizontalAlignment="Left"
                                               Foreground="#1E1E1E" 
                                               FontSize="13" />
                                </Border>
                            </StackPanel>
                            
                            <!-- Borax/Caustic Weight -->
                                <StackPanel Margin="0,0,0,12">
                                <TextBlock Text="Borax/Caustic Weight (lbs):" 
                                           Margin="0,0,0,4"
                                           Foreground="#1E1E1E" 
                                           FontSize="11" />
                                <Border BorderThickness="1" 
                                        BorderBrush="#E0E0E0" 
                                        Padding="8,4" 
                                        Background="White"
                                        CornerRadius="3">
                                    <TextBlock Text="{Binding BoraxCausticWeight, StringFormat={}{0:F0} lbs}" 
                                               HorizontalAlignment="Left"
                                               Foreground="#1E1E1E" 
                                               FontSize="13" />
                                </Border>
                            </StackPanel>
                    
                    <!-- Component Details Button -->
                    <Button x:Name="ShowComponentsButtonMakeReady"
                            Content="Sensors, Valves, and Pumps Table" 
                                        Width="Auto"
                            Height="40"
                                        HorizontalAlignment="Stretch"
                            FontSize="12"
                            FontWeight="SemiBold"
                            Background="#0078D4"
                            Foreground="White"
                            BorderBrush="#005A9E"
                            BorderThickness="1"
                            Click="ShowComponentsButtonMakeReady_Click"
                            Cursor="Hand">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    CornerRadius="4"
                                                    Padding="8">
                                                <ContentPresenter HorizontalAlignment="Center" 
                                                                  VerticalAlignment="Center"/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#005A9E"/>
                                                </Trigger>
                                                <Trigger Property="IsPressed" Value="True">
                                                    <Setter Property="Background" Value="#004578"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Button.Style>
                    </Button>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Grid>
            </Border>

            <!-- Right Card (Current Batch + Formula Steps + Alarm Status) -->
            <Border Grid.Column="1" 
                    BorderThickness="1" 
                    BorderBrush="#E0E0E0" 
                    CornerRadius="8" 
                    Margin="12,0,0,0"
                    Background="White"
                    Effect="{StaticResource DropShadowEffect}">
                <Grid Margin="24">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>


                    <!-- Current Batch -->
                    <Border Grid.Row="0" 
                            BorderThickness="1" 
                            BorderBrush="#E0E0E0" 
                            CornerRadius="6" 
                            Margin="0,0,0,16"
                            Background="White">
                        <StackPanel Margin="16">
                            <TextBlock Text="Current Batch" 
                                       FontWeight="SemiBold" 
                                       FontSize="14" 
                                       HorizontalAlignment="Center" 
                                       Margin="0,0,0,16" 
                                       Foreground="#0078D4" 
                                       LineHeight="18" />
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                
                                <!-- Formula Name -->
                                <StackPanel Grid.Column="0" Margin="0,0,16,0">
                                    <TextBlock Text="Formula Name:"
                                               HorizontalAlignment="Left"
                                               Foreground="#1E1E1E" 
                                               FontSize="14"
                                               LineHeight="18" />
                                    <TextBlock Text="{Binding FormulaName}" 
                                               HorizontalAlignment="Left"
                                               FontSize="14"
                                               Margin="0,8,0,0"
                                               Foreground="#1E1E1E" 
                                               LineHeight="18" />
                                </StackPanel>
                                
                                <!-- Storage Tank -->
                                <StackPanel Grid.Column="1" Margin="0,0,16,0">
                                    <TextBlock Text="Storage Tank:"
                                               HorizontalAlignment="Left"
                                               Foreground="#1E1E1E" 
                                               FontSize="14"
                                               LineHeight="18" />
                                    <TextBlock Text="{Binding StorageTank}" 
                                               HorizontalAlignment="Left"
                                               FontSize="14"
                                               Margin="0,8,0,0"
                                               Foreground="#1E1E1E" 
                                               LineHeight="18" />
                                </StackPanel>
                                
                                <!-- Progress -->
                                <StackPanel Grid.Column="2">
                                    <TextBlock Text="Progress:"
                                               HorizontalAlignment="Left"
                                               Foreground="#1E1E1E" 
                                               FontSize="14"
                                               LineHeight="18" />
                                    <ProgressBar Value="{Binding FormulaProgress}" 
                                                 Maximum="100" 
                                                 Height="20" 
                                                 Margin="0,8,0,0"
                                                 HorizontalAlignment="Stretch" />
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Formula Steps DataGrid -->
                    <DataGrid Grid.Row="1" 
                              ItemsSource="{Binding FormulaSteps}" 
                              AutoGenerateColumns="False" 
                              IsReadOnly="True" 
                              Margin="0,0,0,16"
                              Background="White"
                              BorderBrush="#E0E0E0"
                              Foreground="#1E1E1E"
                              GridLinesVisibility="Horizontal"
                              HeadersVisibility="Column"
                              CanUserResizeColumns="True"
                              CanUserSortColumns="True"
                              AlternatingRowBackground="#F8F9FA"
                              RowBackground="White"
                              HorizontalGridLinesBrush="#E0E0E0"
                              VerticalGridLinesBrush="Transparent">
                        <DataGrid.Resources>
                            <Style TargetType="DataGridRow">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Status}" Value="In Progress">
                                        <Setter Property="Background" Value="#E3F2FD" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.Resources>
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Step" Binding="{Binding Step}" Width="Auto">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="ToolTip" Value="Step" />
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="ToolTip" Value="{Binding Step, StringFormat='Step: {0}'}" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="ToolTip" Value="Description" />
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="ToolTip" Value="{Binding Description, StringFormat='Description: {0}'}" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Preset Amount" Binding="{Binding PresetAmount}" Width="Auto">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="ToolTip" Value="Preset Amount" />
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="ToolTip" Value="{Binding PresetAmount, StringFormat='Preset Amount: {0}'}" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Actual Amount" Binding="{Binding ActualAmount}" Width="Auto">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="ToolTip" Value="Actual Amount" />
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="ToolTip" Value="{Binding ActualAmount, StringFormat='Actual Amount: {0}'}" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Preset Time" Binding="{Binding PresetTime}" Width="Auto">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="ToolTip" Value="Preset Time" />
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="ToolTip" Value="{Binding PresetTime, StringFormat='Preset Time: {0}'}" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="Auto">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="ToolTip" Value="Status" />
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="ToolTip" Value="{Binding Status, StringFormat='Status: {0}'}" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Alarm Status -->
                    <DataGrid Grid.Row="2" 
                              Name="AlarmDataGrid"
                              AutoGenerateColumns="False" 
                              IsReadOnly="True" 
                              Height="164"
                              Background="White"
                              BorderBrush="#E0E0E0"
                              Foreground="#1E1E1E"
                              GridLinesVisibility="Horizontal"
                              HeadersVisibility="Column"
                              CanUserResizeColumns="True"
                              CanUserSortColumns="True"
                              AlternatingRowBackground="#F8F9FA"
                              RowBackground="White"
                              HorizontalGridLinesBrush="#E0E0E0"
                              VerticalGridLinesBrush="Transparent">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="Auto">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="ToolTip" Value="Type" />
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="ToolTip" Value="{Binding Type, StringFormat='Type: {0}'}" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="Auto">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="ToolTip" Value="Status" />
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="ToolTip" Value="{Binding Status, StringFormat='Status: {0}'}" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Alarm Number" Binding="{Binding AlarmNumber}" Width="Auto">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="ToolTip" Value="Alarm Number" />
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="ToolTip" Value="{Binding AlarmNumber, StringFormat='Alarm Number: {0}'}" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Alarm Description" Binding="{Binding AlarmDescription}" Width="2*">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="ToolTip" Value="Alarm Description" />
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="ToolTip" Value="{Binding AlarmDescription, StringFormat='Alarm Description: {0}'}" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Alarm Date" Binding="{Binding AlarmDate}" Width="Auto">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="ToolTip" Value="Alarm Date" />
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="ToolTip" Value="{Binding AlarmDate, StringFormat='Alarm Date: {0}'}" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Alarm Time" Binding="{Binding AlarmTime}" Width="Auto">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="ToolTip" Value="Alarm Time" />
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="ToolTip" Value="{Binding AlarmTime, StringFormat='Alarm Time: {0}'}" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Acknowledge Date" Binding="{Binding AcknowledgeDate}" Width="Auto">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="ToolTip" Value="Acknowledge Date" />
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="ToolTip" Value="{Binding AcknowledgeDate, StringFormat='Acknowledge Date: {0}'}" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Acknowledge Time" Binding="{Binding AcknowledgeTime}" Width="Auto">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="ToolTip" Value="Acknowledge Time" />
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="ToolTip" Value="{Binding AcknowledgeTime, StringFormat='Acknowledge Time: {0}'}" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </Border>

        </Grid>

        <!-- Footer Control Bar -->
        <Border Grid.Row="1" 
                BorderThickness="0,1,0,0" 
                BorderBrush="#E0E0E0" 
                Background="White"
                Padding="24,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1*" />
                    <ColumnDefinition Width="2*" />
                    <ColumnDefinition Width="1*" />
                </Grid.ColumnDefinitions>
                
                <!-- Left side - System Status -->
                <StackPanel Grid.Column="0" 
                            Orientation="Horizontal" 
                            VerticalAlignment="Center">
                    <Ellipse Width="12" 
                             Height="12" 
                             Fill="{Binding PlcStatusBrush}"
                             VerticalAlignment="Center" />
                    <TextBlock Text="{Binding PlcStatusText}" 
                               Margin="8,0,0,0"
                               VerticalAlignment="Center"
                               Foreground="#1E1E1E"
                               FontSize="14"
                               LineHeight="18" />
                </StackPanel>
                
                <!-- Middle - Centered buttons -->
                <StackPanel Grid.Column="1" 
                            Orientation="Horizontal" 
                            HorizontalAlignment="Center">
                    <Button x:Name="ProcessToggleButton"
                            Content="PAUSE PROCESS" 
                            Width="160"
                            Height="40"
                            Margin="0,0,16,0"
                            Style="{StaticResource PauseButtonStyle}"
                            Click="ProcessToggleButton_Click" />
                    
                    <Button Content="EMERGENCY STOP" 
                            Width="160"
                            Height="40"
                            Style="{StaticResource EmergencyButtonStyle}" />
                </StackPanel>
                
                <!-- Right side - Close button -->
                <Button Grid.Column="2" 
                        Content="CLOSE" 
                        Width="120"
                        Height="40"
                        HorizontalAlignment="Right"
                        Style="{StaticResource CloseButtonStyle}"
                        Click="Close_Click" />
            </Grid>
        </Border>
        
        <!-- WPF Popup for Make Ready Tank Components -->
        <Popup x:Name="ComponentPopupMakeReady"
               PlacementTarget="{Binding ElementName=ShowComponentsButtonMakeReady}"
               Placement="Right"
               StaysOpen="False"
               AllowsTransparency="True">
            <Border Background="White"
                    BorderBrush="#0078D4"
                    BorderThickness="2"
                    CornerRadius="8"
                    Padding="20"
                    Width="480"
                    Effect="{StaticResource DropShadowEffect}">
                <StackPanel>
                    <!-- Header -->
                    <TextBlock Text="Make Ready Tank - Sensors, Valves, and Pumps" 
                               FontSize="15" 
                               FontWeight="SemiBold"
                               Foreground="#0078D4"
                               Margin="0,0,0,16" />
                    
                    <!-- Component Grid (2 columns x 11 rows for 22 components) -->
                    <Grid x:Name="ComponentGridMakeReady">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        
                        <!-- Components will be dynamically added in code-behind -->
                    </Grid>
                </StackPanel>
            </Border>
        </Popup>
    </Grid>
</UserControl>
