<Window x:Class="Ring.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:views="clr-namespace:Ring.Views.Dashboard"
        Title="Industrial Control System" Height="900" Width="1400"
        WindowStartupLocation="CenterScreen" 
        WindowStyle="None" ResizeMode="CanResizeWithGrip" 
        Background="#F5F5F5" FontFamily="Segoe UI" FontSize="14"
        Icon="pack://application:,,,/Images/RW-Blue.ico">

    <Grid Margin="5">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Left Sidebar -->
        <Border Grid.Column="0" Background="#1E3A8A" Width="250">
            <StackPanel Margin="20,25,20,20">
                <!-- Logo Section -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,35">
                    <TextBlock Text="🏭" FontSize="28" Margin="0,0,12,0" VerticalAlignment="Center"/>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="RS3000" FontSize="24" FontWeight="Bold" Foreground="White" LineHeight="28"/>
                        <TextBlock Text="Industrial Control" FontSize="13" Foreground="#CCFFFFFF" FontWeight="SemiBold" Margin="0,2,0,0"/>
                    </StackPanel>
                </StackPanel>

                <!-- Navigation Menu -->
                <StackPanel>
                    <!-- Dashboard -->
                    <Button Background="Transparent" Foreground="White" 
                            BorderThickness="0" Padding="15,14" HorizontalContentAlignment="Left"
                            Margin="0,0,0,12"
                            Click="Dashboard_Click"
                            Cursor="Hand"
                            Height="44">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <materialDesign:PackIcon Kind="ViewDashboard" Width="22" Height="22" Margin="0,0,12,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Dashboard" VerticalAlignment="Center" FontSize="15" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>

                    <!-- Process -->
                    <StackPanel Margin="0,0,0,12">
                        <Button Background="Transparent" Foreground="White" 
                                BorderThickness="0" Padding="15,14" HorizontalContentAlignment="Left"
                                Click="Process_Click" MouseEnter="Process_MouseEnter" MouseLeave="Process_MouseLeave"
                                Cursor="Hand"
                                Height="44">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="Cog" Width="22" Height="22" Margin="0,0,12,0" VerticalAlignment="Center"/>
                                <TextBlock Text="Process" VerticalAlignment="Center" FontSize="15" FontWeight="SemiBold"/>
                            </StackPanel>
                        </Button>
                        <Border x:Name="ProcessSubmenu" Background="#2D4A8A" Margin="15,5,0,0" 
                                CornerRadius="4" Padding="10" Visibility="Collapsed">
                            <StackPanel>
                                <Button Content="Alarm" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="Alarms_Click"/>
                                <Button Content="Hold" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Click="Hold_Click"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Main Screen -->
                    <StackPanel Margin="0,0,0,12">
                        <Button Background="Transparent" Foreground="White" 
                                BorderThickness="0" Padding="15,14" HorizontalContentAlignment="Left"
                                Click="MainScreen_Click" MouseEnter="MainScreen_MouseEnter" MouseLeave="MainScreen_MouseLeave"
                                Cursor="Hand"
                                Height="44">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="Monitor" Width="22" Height="22" Margin="0,0,12,0" VerticalAlignment="Center"/>
                                <TextBlock Text="Main Screen" VerticalAlignment="Center" FontSize="15" FontWeight="SemiBold"/>
                            </StackPanel>
                        </Button>
                        <Border x:Name="MainScreenSubmenu" Background="#2D4A8A" Margin="15,5,0,0" 
                                CornerRadius="4" Padding="10" Visibility="Collapsed">
                            <StackPanel>
                                <Button Content="Make Ready Tank" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="TankMonitoring_Click"/>
                                <Button Content="Storage Group" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="StorageGroup_Click"/>
                                <Button Content="Viscometer" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Click="UseTanks_Click"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Reports -->
                    <StackPanel Margin="0,0,0,12">
                        <Button Background="Transparent" Foreground="White" 
                                BorderThickness="0" Padding="15,14" HorizontalContentAlignment="Left"
                                Click="Report_Click" MouseEnter="Reports_MouseEnter" MouseLeave="Reports_MouseLeave"
                                Cursor="Hand"
                                Height="44">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="FileDocument" Width="22" Height="22" Margin="0,0,12,0" VerticalAlignment="Center"/>
                                <TextBlock Text="Reports" VerticalAlignment="Center" FontSize="15" FontWeight="SemiBold"/>
                            </StackPanel>
                        </Button>
                        <Border x:Name="ReportsSubmenu" Background="#2D4A8A" Margin="15,5,0,0" 
                                CornerRadius="4" Padding="10" Visibility="Collapsed">
                            <StackPanel>
                                <Button Content="Batch Query Report" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="BatchQuery_Click"/>
                                <Button Content="Usage Report" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="UsageReport_Click"/>
                                <Button Content="Batch History Report" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="BatchHistoryReport_Click"/>
                                <Button Content="Batch History Usage Report" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="BatchHistoryUsageReport_Click"/>
                                <Button Content="Alarm History" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="AlarmHistory_Click"/>
                                <Button Content="Inventory Report" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="InventoryReport_Click"/>
                                <Button Content="Formula Report" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="FormulaReport_Click"/>
                                <Button Content="Shift Consumption" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="ShiftConsumption_Click"/>
                                <Button Content="Database Export" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Click="DatabaseTest_Click"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Batch Start -->
                    <StackPanel Margin="0,0,0,12">
                        <Button Background="Transparent" Foreground="White" 
                                BorderThickness="0" Padding="15,14" HorizontalContentAlignment="Left"
                                Click="BatchStart_Click" MouseEnter="BatchStart_MouseEnter" MouseLeave="BatchStart_MouseLeave"
                                Cursor="Hand"
                                Height="44">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="Play" Width="22" Height="22" Margin="0,0,12,0" VerticalAlignment="Center"/>
                                <TextBlock Text="Batch Start" VerticalAlignment="Center" FontSize="15" FontWeight="SemiBold"/>
                            </StackPanel>
                        </Button>
                        <Border x:Name="BatchStartSubmenu" Background="#2D4A8A" Margin="15,5,0,0" 
                                CornerRadius="4" Padding="10" Visibility="Collapsed">
                            <StackPanel>
                                <Button Content="Storage Tank 1" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="StorageTank1_Click"/>
                                <Button Content="Storage Tank 2" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="StorageTank2_Click"/>
                                <Button Content="LOW / MID D/B TANK" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="LowMidtank_Click"/>
                                <Button Content="Storage Tank 4" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Click="StorageTank4_Click"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- TVC Control -->
                    <StackPanel Margin="0,0,0,12">
                        <Button Background="Transparent" Foreground="White" 
                                BorderThickness="0" Padding="15,14" HorizontalContentAlignment="Left"
                                Click="TVCControl_Click" MouseEnter="TVCControl_MouseEnter" MouseLeave="TVCControl_MouseLeave"
                                Cursor="Hand"
                                Height="44">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="Tune" Width="22" Height="22" Margin="0,0,12,0" VerticalAlignment="Center"/>
                                <TextBlock Text="TVC Control" VerticalAlignment="Center" FontSize="15" FontWeight="SemiBold"/>
                            </StackPanel>
                        </Button>
                        <Border x:Name="TVCControlSubmenu" Background="#2D4A8A" Margin="15,5,0,0" 
                                CornerRadius="4" Padding="10" Visibility="Collapsed">
                            <StackPanel>
                                <Button Content="Storage Tank 1" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="TVCStorageTank1_Click"/>
                                <Button Content="Storage Tank 2" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="TVCStorageTank2_Click"/>
                                <Button Content="LOW / MID D/B TANK" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="TVClowmidtank_Click"/>
                                <Button Content="Storage Tank 4" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Click="TVCStorageTank4_Click"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Use Tanks -->
                    <Button Background="Transparent" Foreground="White" 
                            BorderThickness="0" Padding="15,14" HorizontalContentAlignment="Left"
                            Margin="0,0,0,12"
                            Click="UseTanks_Click"
                            Cursor="Hand"
                            Height="44">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <materialDesign:PackIcon Kind="Water" Width="22" Height="22" Margin="0,0,12,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Use Tanks" VerticalAlignment="Center" FontSize="15" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>

                    <!-- Shifts -->
                    <StackPanel Margin="0,0,0,12">
                        <Button x:Name="ShiftsButton" Background="Transparent" Foreground="White" 
                                BorderThickness="0" Padding="15,14" HorizontalContentAlignment="Left"
                                Click="Shifts_Click" MouseEnter="Shifts_MouseEnter" MouseLeave="Shifts_MouseLeave"
                                Cursor="Hand"
                                Height="44">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="Clock" Width="22" Height="22" Margin="0,0,12,0" VerticalAlignment="Center"/>
                                <TextBlock Text="Shifts" VerticalAlignment="Center" FontSize="15" FontWeight="SemiBold"/>
                            </StackPanel>
                        </Button>
                        <Border x:Name="ShiftsSubmenu" Background="#2D4A8A" Margin="15,5,0,0" 
                                CornerRadius="4" Padding="10" Visibility="Collapsed">
                            <StackPanel>
                                <Button Content="Shift Control" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="ShiftControl_Click"/>
                                <Button Content="Shift 1" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="Shift1_Click"/>
                                <Button Content="Shift 2" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="Shift2_Click"/>
                                <Button Content="Shift 3" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Click="Shift3_Click"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Language -->
                    <Button Background="Transparent" Foreground="White" 
                            BorderThickness="0" Padding="15,14" HorizontalContentAlignment="Left"
                            Margin="0,0,0,12"
                            Click="Language_Click"
                            Cursor="Hand"
                            Height="44">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <materialDesign:PackIcon Kind="Translate" Width="22" Height="22" Margin="0,0,12,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Language" VerticalAlignment="Center" FontSize="15" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>

                    <!-- Setup -->
                    <StackPanel Margin="0,0,0,12">
                        <Button Background="Transparent" Foreground="White" 
                                BorderThickness="0" Padding="15,14" HorizontalContentAlignment="Left"
                                Click="Setup_Click" MouseEnter="Setup_MouseEnter" MouseLeave="Setup_MouseLeave"
                                Cursor="Hand"
                                Height="44">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="Settings" Width="22" Height="22" Margin="0,0,12,0" VerticalAlignment="Center"/>
                                <TextBlock Text="Setup" VerticalAlignment="Center" FontSize="15" FontWeight="SemiBold"/>
                            </StackPanel>
                        </Button>
                        <Border x:Name="SetupSubmenu" Background="#2D4A8A" Margin="15,5,0,0" 
                                CornerRadius="4" Padding="10" Visibility="Collapsed">
                            <StackPanel>
                                <!-- Always visible -->
                                <Button Content="Password" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="Password_Click"/>
                                
                                <!-- Protected items - hidden until password verified -->
                                <Button x:Name="MakeReadyTankInventoryEditButton" 
                                        Content="Make Ready Tank Inventory Edit" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="MakeReadyTankInventoryEdit_Click"/>
                                
                                <Button x:Name="MakeReadyTankFormulaEditButton" 
                                        Content="Make Ready Tank Formula Edit" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="MakeReadyTankFormulaEdit_Click"/>
                                
                                <Button x:Name="MakeReadyTankFormulaExchangeButton" 
                                        Content="Make Ready Tank Formula Exchange" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="MakeReadyTankFormulaExchange_Click"/>
                                
                                <Button x:Name="MakeReadyTankNamesEditButton" 
                                        Content="Make Ready Tank Names Edit" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="MakeReadyTankNamesEdit_Click"/>
                                
                                <Button x:Name="StorageGroupSystemNamesEditButton" 
                                        Content="Storage Group System Names Edit" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="StorageGroupSystemNamesEdit_Click"/>
                                
                                <!-- Shift Names and Spans with submenu -->
                                <StackPanel Margin="0,0,0,4">
                                    <Button x:Name="ShiftNamesAndSpansButton" 
                                            Background="Transparent" Foreground="White" 
                                            BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                            Visibility="Collapsed"
                                            Click="ShiftNamesAndSpans_Click" 
                                            MouseEnter="ShiftNamesAndSpans_MouseEnter" 
                                            MouseLeave="ShiftNamesAndSpans_MouseLeave">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Shift Names and Spans" VerticalAlignment="Center"/>
                                            <TextBlock Text=" >" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="10"/>
                                        </StackPanel>
                                    </Button>
                                    <Border x:Name="ShiftNamesAndSpansSubmenu" 
                                            Background="#1E3A8A" 
                                            Margin="15,5,0,0" 
                                            CornerRadius="4" 
                                            Padding="10" 
                                            Visibility="Collapsed">
                                        <StackPanel>
                                            <!-- Submenu items will be added here if needed -->
                                            <TextBlock Text="Submenu items" Foreground="White" FontSize="12"/>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                                
                                <Button x:Name="EditPasswordsButton" 
                                        Content="Edit Passwords" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="EditPasswords_Click"/>
                                
                                <!-- Communication Disk Logging with submenu -->
                                <StackPanel Margin="0,0,0,4">
                                    <Button x:Name="CommunicationDiskLoggingButton" 
                                            Background="Transparent" Foreground="White" 
                                            BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                            Visibility="Collapsed"
                                            Click="CommunicationDiskLogging_Click" 
                                            MouseEnter="CommunicationDiskLogging_MouseEnter" 
                                            MouseLeave="CommunicationDiskLogging_MouseLeave">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Communication Disk Logging" VerticalAlignment="Center"/>
                                            <TextBlock Text=" >" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="10"/>
                                        </StackPanel>
                                    </Button>
                                    <Border x:Name="CommunicationDiskLoggingSubmenu" 
                                            Background="#1E3A8A" 
                                            Margin="15,5,0,0" 
                                            CornerRadius="4" 
                                            Padding="10" 
                                            Visibility="Collapsed">
                                        <StackPanel>
                                            <!-- Submenu items will be added here if needed -->
                                            <TextBlock Text="Submenu items" Foreground="White" FontSize="12"/>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                                
                                <Button x:Name="UpdateProcessorTimeDateButton" 
                                        Content="Update Processor Time/Date" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Visibility="Collapsed"
                                        Click="UpdateProcessorTimeDate_Click"/>
                                
                                <!-- Admin-only items - shown only when admin password is entered -->
                                <Button x:Name="MixersButton" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="Mixers_Click" 
                                        MouseEnter="Mixers_MouseEnter" 
                                        MouseLeave="Mixers_MouseLeave">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Mixers" VerticalAlignment="Center"/>
                                        <TextBlock Text=" >" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="10"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button x:Name="DistributionButton" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="Distribution_Click" 
                                        MouseEnter="Distribution_MouseEnter" 
                                        MouseLeave="Distribution_MouseLeave">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Distribution" VerticalAlignment="Center"/>
                                        <TextBlock Text=" >" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="10"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button x:Name="ViscometerButton" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="Viscometer_Click" 
                                        MouseEnter="Viscometer_MouseEnter" 
                                        MouseLeave="Viscometer_MouseLeave">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Viscometer" VerticalAlignment="Center"/>
                                        <TextBlock Text=" >" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="10"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button x:Name="GroupsButton" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="Groups_Click" 
                                        MouseEnter="Groups_MouseEnter" 
                                        MouseLeave="Groups_MouseLeave">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Groups" VerticalAlignment="Center"/>
                                        <TextBlock Text=" >" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="10"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button x:Name="TanksButton" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="Tanks_Click" 
                                        MouseEnter="Tanks_MouseEnter" 
                                        MouseLeave="Tanks_MouseLeave">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Tanks" VerticalAlignment="Center"/>
                                        <TextBlock Text=" >" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="10"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button x:Name="DataEntryButton" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="DataEntry_Click" 
                                        MouseEnter="DataEntry_MouseEnter" 
                                        MouseLeave="DataEntry_MouseLeave">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Data Entry" VerticalAlignment="Center"/>
                                        <TextBlock Text=" >" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="10"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button x:Name="AlarmsButton" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="AlarmsAdmin_Click" 
                                        MouseEnter="AlarmsAdmin_MouseEnter" 
                                        MouseLeave="AlarmsAdmin_MouseLeave">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Alarms" VerticalAlignment="Center"/>
                                        <TextBlock Text=" >" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="10"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button x:Name="InventoryButton" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="Inventory_Click" 
                                        MouseEnter="Inventory_MouseEnter" 
                                        MouseLeave="Inventory_MouseLeave">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Inventory" VerticalAlignment="Center"/>
                                        <TextBlock Text=" >" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="10"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button x:Name="MixerBatchFormulaDataButton" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="MixerBatchFormulaData_Click" 
                                        MouseEnter="MixerBatchFormulaData_MouseEnter" 
                                        MouseLeave="MixerBatchFormulaData_MouseLeave">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Mixer Batch/Formula Data" VerticalAlignment="Center"/>
                                        <TextBlock Text=" >" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="10"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button x:Name="DistributionBatchDataButton" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="DistributionBatchData_Click" 
                                        MouseEnter="DistributionBatchData_MouseEnter" 
                                        MouseLeave="DistributionBatchData_MouseLeave">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Distribution Batch Data" VerticalAlignment="Center"/>
                                        <TextBlock Text=" >" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="10"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button x:Name="ShiftsAdminButton" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="ShiftsAdmin_Click" 
                                        MouseEnter="ShiftsAdmin_MouseEnter" 
                                        MouseLeave="ShiftsAdmin_MouseLeave">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Shifts" VerticalAlignment="Center"/>
                                        <TextBlock Text=" >" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="10"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button x:Name="PasswordSubmenuButton" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="PasswordSubmenu_Click" 
                                        MouseEnter="PasswordSubmenu_MouseEnter" 
                                        MouseLeave="PasswordSubmenu_MouseLeave">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Password" VerticalAlignment="Center"/>
                                        <TextBlock Text=" >" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="10"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button x:Name="CommunicationButton" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Visibility="Collapsed"
                                        Click="Communication_Click" 
                                        MouseEnter="Communication_MouseEnter" 
                                        MouseLeave="Communication_MouseLeave">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Communication" VerticalAlignment="Center"/>
                                        <TextBlock Text=" >" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="10"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button x:Name="ImportExportSetupDatabaseButton" 
                                        Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Visibility="Collapsed"
                                        Click="ImportExportSetupDatabase_Click" 
                                        MouseEnter="ImportExportSetupDatabase_MouseEnter" 
                                        MouseLeave="ImportExportSetupDatabase_MouseLeave">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Import/Export Setup Database" VerticalAlignment="Center"/>
                                        <TextBlock Text=" >" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="10"/>
                                    </StackPanel>
                                </Button>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Window -->
                    <StackPanel Margin="0,0,0,12">
                        <Button Background="Transparent" Foreground="White" 
                                BorderThickness="0" Padding="15,14" HorizontalContentAlignment="Left"
                                Click="Window_Click" MouseEnter="Window_MouseEnter" MouseLeave="Window_MouseLeave"
                                Cursor="Hand"
                                Height="44">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="WindowRestore" Width="22" Height="22" Margin="0,0,12,0" VerticalAlignment="Center"/>
                                <TextBlock Text="Window" VerticalAlignment="Center" FontSize="15" FontWeight="SemiBold"/>
                            </StackPanel>
                        </Button>
                        <Border x:Name="WindowSubmenu" Background="#2D4A8A" Margin="15,5,0,0" 
                                CornerRadius="4" Padding="10" Visibility="Collapsed">
                            <StackPanel>
                                <Button Content="Tile" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="SystemStatus_Click"/>
                                <Button Content="Cascade" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Click="SystemStatus_Click"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Help -->
                    <StackPanel Margin="0,0,0,20">
                        <Button Background="Transparent" Foreground="White" 
                                BorderThickness="0" Padding="15,14" HorizontalContentAlignment="Left"
                                Click="Help_Click" MouseEnter="Help_MouseEnter" MouseLeave="Help_MouseLeave"
                                Cursor="Hand"
                                Height="44">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <materialDesign:PackIcon Kind="HelpCircle" Width="22" Height="22" Margin="0,0,12,0" VerticalAlignment="Center"/>
                                <TextBlock Text="Help" VerticalAlignment="Center" FontSize="15" FontWeight="SemiBold"/>
                            </StackPanel>
                        </Button>
                        <Border x:Name="HelpSubmenu" Background="#2D4A8A" Margin="15,5,0,0" 
                                CornerRadius="4" Padding="10" Visibility="Collapsed">
                            <StackPanel>
                                <Button Content="Contents" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Margin="0,0,0,4"
                                        Click="SystemStatus_Click"/>
                                <Button Content="About" Background="Transparent" Foreground="White" 
                                        BorderThickness="0" Padding="10,8" HorizontalContentAlignment="Left"
                                        Click="SystemStatus_Click"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </StackPanel>

                <!-- System Status Footer -->
                <Border Background="#10B981" CornerRadius="25" Padding="12,8" Margin="0,25,0,0">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <Ellipse Width="10" Height="10" Fill="White" Margin="0,0,10,0" VerticalAlignment="Center"/>
                        <TextBlock Text="System Online" Foreground="White" FontSize="13" FontWeight="SemiBold" VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </Border>

        <!-- Main Content Area -->
        <Grid Grid.Column="1" MouseLeftButtonDown="MainContent_MouseLeftButtonDown">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" Background="#1E3A8A" Padding="20">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Logo and Title -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <Image Source="pack://application:,,,/Images/BannerRingwood.png" Width="150" Height="80" Margin="0,0,15,0" Stretch="Uniform"/>
                        <StackPanel>
                            <TextBlock Text="Industrial Control System" 
                                       Foreground="White" FontSize="24" FontWeight="Bold"/>
                            <TextBlock Text="Advanced Process Monitoring" 
                                       Foreground="#B3FFFFFF" FontSize="14" Margin="0,5,0,0"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- System Status -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0">
                        <Ellipse Width="12" Height="12" Fill="#10B981" Margin="0,0,8,0"/>
                        <TextBlock Text="System Online" Foreground="White" FontSize="16" VerticalAlignment="Center" Margin="0,0,20,0"/>
                        <Button x:Name="SimulationToggleButton" Content="Simulation Mode" 
                                Click="ToggleSimulationMode_Click"
                                Background="White" Foreground="#1A3A8A" 
                                BorderThickness="1" BorderBrush="#1A3A8A"
                                Padding="10,5" FontSize="12" FontWeight="SemiBold"
                                Cursor="Hand" VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- Time and Controls -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock x:Name="SystemTimeText" Text="{Binding Source={x:Static sys:DateTime.Now}, StringFormat='yyyy-MM-dd HH:mm:ss'}" 
                                   Foreground="White" FontSize="14" Margin="0,0,20,0"/>
                        <Button Content="🗕" Margin="5" Click="Minimize_Click" 
                                Background="Transparent" Foreground="White" BorderThickness="0" FontSize="16"/>
                        <Button Content="🗖" Margin="5" Click="Maximize_Click" 
                                Background="Transparent" Foreground="White" BorderThickness="0" FontSize="16"/>
                        <Button Content="✕" Margin="5" Click="Close_Click" 
                                Background="Transparent" Foreground="White" BorderThickness="0" FontSize="16"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Main Content Area - Dashboard View -->
            <ContentControl x:Name="MainContentArea" Grid.Row="1">
                <views:DashboardView />
            </ContentControl>
        </Grid>
    </Grid>
</Window>