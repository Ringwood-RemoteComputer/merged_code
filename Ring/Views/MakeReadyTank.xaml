<UserControl x:Class="Ring.Views.MakeReadyTank"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:controls="clr-namespace:Ring.Views.UserControls"
             xmlns:tankModels="clr-namespace:Ring.Views.UserControls.TankModels">
    
    <Grid Background="#F5F5F5">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>


        <!-- Main content area -->
        <Grid Grid.Row="0" Margin="24">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1*" />
                <ColumnDefinition Width="2*" />
                <ColumnDefinition Width="1*" />
            </Grid.ColumnDefinitions>

            <!-- Left Section (Tank Visualization & Controls) -->
            <Border Grid.Column="0" 
                    BorderThickness="1" 
                    BorderBrush="#E0E0E0" 
                    CornerRadius="8" 
                    Margin="0,0,16,0"
                    Background="White"
                    Effect="{StaticResource DropShadowEffect}">
                <StackPanel Margin="24">
                    <!-- Make Ready Tank Card -->
                    <Border BorderThickness="1" 
                            BorderBrush="#E0E0E0" 
                            CornerRadius="6" 
                            Margin="0,0,0,12"
                            Background="White">
                        <StackPanel Margin="12">
                <TextBlock Text="Make Ready Tank" 
                                       FontWeight="SemiBold" 
                                       FontSize="14" 
                                       HorizontalAlignment="Center" 
                                       Margin="0,0,0,8" 
                                       Foreground="#0078D4" />
                            
                            <!-- Tank Visualization Control -->
                            <Border BorderThickness="1" 
                                    BorderBrush="#E0E0E0" 
                                    CornerRadius="6"
                                    Background="#F8F9FA"
                                    Margin="0,0,0,8"
                                    Padding="8">
                                <tankModels:TankVisualizationControl 
                                    DataContext="{Binding}"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center" />
                            </Border>
                            
                            
                            <TextBlock Text="Tank Data" 
                                       FontWeight="SemiBold" 
                                       FontSize="12" 
                                       HorizontalAlignment="Center" 
                                       Margin="0,0,0,6" 
                                       Foreground="#1E1E1E" />
                            
                            <!-- Tank Weight -->
                            <StackPanel Margin="0,0,0,6">
                                <TextBlock Text="Tank Weight (lbs):" 
                                           Margin="0,0,0,4"
                                           Foreground="#1E1E1E" 
                                           FontSize="11" />
                                <Border BorderThickness="1" 
                                        BorderBrush="#E0E0E0" 
                                        Padding="8,4" 
                                        Margin="0,0,0,0"
                                        Background="White"
                                        CornerRadius="3">
                                    <TextBlock Text="{Binding Weight, StringFormat={}{0:F0} lbs}" 
                                               HorizontalAlignment="Left"
                                               Foreground="#1E1E1E" 
                                               FontSize="13" />
                                </Border>
                            </StackPanel>
                            
                            <!-- Temperature -->
                            <StackPanel Margin="0,0,0,6">
                                <TextBlock Text="Temperature (°F):" 
                                           Margin="0,0,0,4"
                                           Foreground="#1E1E1E" 
                                           FontSize="11" />
                                <Border BorderThickness="1" 
                                        BorderBrush="#E0E0E0" 
                                        Padding="8,4" 
                                        Margin="0,0,0,0"
                                        Background="White"
                                        CornerRadius="3">
                                    <TextBlock Text="{Binding Temperature, StringFormat={}{0:F0}°F}" 
                                               HorizontalAlignment="Left"
                                               Foreground="#1E1E1E" 
                                               FontSize="13" />
                                </Border>
                            </StackPanel>
                            
                            <!-- Borax/Caustic Weight -->
                            <StackPanel Margin="0,0,0,6">
                                <TextBlock Text="Borax/Caustic Weight (lbs):" 
                                           Margin="0,0,0,4"
                                           Foreground="#1E1E1E" 
                                           FontSize="11" />
                                <Border BorderThickness="1" 
                                        BorderBrush="#E0E0E0" 
                                        Padding="8,4" 
                                        Margin="0,0,0,0"
                                        Background="White"
                                        CornerRadius="3">
                                    <TextBlock Text="{Binding BoraxCausticWeight, StringFormat={}{0:F0} lbs}" 
                                               HorizontalAlignment="Left"
                                               Foreground="#1E1E1E" 
                                               FontSize="13" />
                                </Border>
                        </StackPanel>
                        </StackPanel>
                    </Border>

                        </StackPanel>
            </Border>

            <!-- Middle Section (Real-time Monitoring & Formula Steps) -->
            <Border Grid.Column="1" 
                    BorderThickness="1" 
                    BorderBrush="#E0E0E0" 
                    CornerRadius="8" 
                    Margin="8,0"
                    Background="White"
                    Effect="{StaticResource DropShadowEffect}">
                <Grid Margin="24">
                <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>


                    <!-- Current Batch -->
                    <Border Grid.Row="0" 
                            BorderThickness="1" 
                            BorderBrush="#E0E0E0" 
                            CornerRadius="6" 
                            Margin="0,0,0,16"
                            Background="White">
                        <StackPanel Margin="16">
                            <TextBlock Text="Current Batch" 
                                       FontWeight="SemiBold" 
                                       FontSize="14" 
                                       HorizontalAlignment="Center" 
                                       Margin="0,0,0,16" 
                                       Foreground="#0078D4" 
                                       LineHeight="18" />
                            
                            <Grid>
                        <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                                <!-- Formula Name -->
                                <StackPanel Grid.Column="0" Margin="0,0,16,0">
                                    <TextBlock Text="Formula Name:"
                                               HorizontalAlignment="Left"
                                               Foreground="#1E1E1E" 
                                               FontSize="14"
                                               LineHeight="18" />
                                    <TextBlock Text="{Binding FormulaName}" 
                                               HorizontalAlignment="Left"
                                               FontSize="14"
                                               Margin="0,8,0,0"
                                               Foreground="#1E1E1E" 
                                               LineHeight="18" />
                        </StackPanel>

                                <!-- Storage Tank -->
                                <StackPanel Grid.Column="1" Margin="0,0,16,0">
                                    <TextBlock Text="Storage Tank:"
                                               HorizontalAlignment="Left"
                                               Foreground="#1E1E1E" 
                                               FontSize="14"
                                               LineHeight="18" />
                                    <TextBlock Text="{Binding StorageTank}" 
                                               HorizontalAlignment="Left"
                                               FontSize="14"
                                               Margin="0,8,0,0"
                                               Foreground="#1E1E1E" 
                                               LineHeight="18" />
                        </StackPanel>

                                <!-- Progress -->
                        <StackPanel Grid.Column="2">
                                    <TextBlock Text="Progress:"
                                               HorizontalAlignment="Left"
                                               Foreground="#1E1E1E" 
                                               FontSize="14"
                                               LineHeight="18" />
                            <ProgressBar Value="{Binding FormulaProgress}" 
                                         Maximum="100" 
                                         Height="20" 
                                                 Margin="0,8,0,0"
                                                 HorizontalAlignment="Stretch" />
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>

                <!-- Formula Steps DataGrid -->
                    <DataGrid Grid.Row="1" 
                              ItemsSource="{Binding FormulaSteps}" 
                              AutoGenerateColumns="False" 
                              IsReadOnly="True"
                              Margin="0,0,0,16"
                              Background="White"
                              BorderBrush="#E0E0E0"
                              Foreground="#1E1E1E"
                              GridLinesVisibility="Horizontal"
                              HeadersVisibility="Column"
                              CanUserResizeColumns="True"
                              CanUserSortColumns="True"
                              AlternatingRowBackground="#F8F9FA"
                              RowBackground="White"
                              HorizontalGridLinesBrush="#E0E0E0"
                              VerticalGridLinesBrush="Transparent">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Step" Binding="{Binding Step}" Width="Auto" />
                            <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*" />
                            <DataGridTextColumn Header="Preset Amount" Binding="{Binding PresetAmount}" Width="Auto" />
                            <DataGridTextColumn Header="Actual Amount" Binding="{Binding ActualAmount}" Width="Auto" />
                            <DataGridTextColumn Header="Preset Time" Binding="{Binding PresetTime}" Width="Auto" />
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="Auto" />
                        </DataGrid.Columns>
                    </DataGrid>

                <!-- Alarm Status -->
                    <DataGrid Grid.Row="2" 
                              Name="AlarmDataGrid"
                              AutoGenerateColumns="False" 
                              IsReadOnly="True"
                              Height="164"
                              Background="White"
                              BorderBrush="#E0E0E0"
                              Foreground="#1E1E1E"
                              GridLinesVisibility="Horizontal"
                              HeadersVisibility="Column"
                              CanUserResizeColumns="True"
                              CanUserSortColumns="True"
                              AlternatingRowBackground="#F8F9FA"
                              RowBackground="White"
                              HorizontalGridLinesBrush="#E0E0E0"
                              VerticalGridLinesBrush="Transparent">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="Auto" />
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="Auto" />
                            <DataGridTextColumn Header="Alarm Number" Binding="{Binding AlarmNumber}" Width="Auto" />
                            <DataGridTextColumn Header="Alarm Description" Binding="{Binding AlarmDescription}" Width="2*" />
                            <DataGridTextColumn Header="Alarm Date" Binding="{Binding AlarmDate}" Width="Auto" />
                            <DataGridTextColumn Header="Alarm Time" Binding="{Binding AlarmTime}" Width="Auto" />
                            <DataGridTextColumn Header="Acknowledge Date" Binding="{Binding AcknowledgeDate}" Width="Auto" />
                            <DataGridTextColumn Header="Acknowledge Time" Binding="{Binding AcknowledgeTime}" Width="Auto" />
                        </DataGrid.Columns>
                    </DataGrid>
            </Grid>
            </Border>

            <!-- Right Section (Configuration & Actions) -->
            <Border Grid.Column="2" 
                    BorderThickness="1" 
                    BorderBrush="#E0E0E0" 
                    CornerRadius="8" 
                    Margin="16,0,0,0"
                    Background="White"
                    Effect="{StaticResource DropShadowEffect}">
                <Grid Margin="24">
                <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                    <!-- Batch Progress -->
                    <Border Grid.Row="0" 
                            BorderThickness="1" 
                            BorderBrush="#E0E0E0" 
                            CornerRadius="6" 
                            Margin="0,0,0,16"
                            Background="White">
                        <StackPanel Margin="16">
                            <TextBlock Text="Batch Progress" 
                                       FontWeight="SemiBold" 
                                       FontSize="14" 
                                       HorizontalAlignment="Center" 
                                       Margin="0,0,0,16" 
                                       Foreground="#0078D4" 
                                       LineHeight="18" />
                            
                            <!-- Current Step -->
                            <StackPanel Margin="0,0,0,8">
                                <TextBlock Text="Current Step:" 
                                           Margin="0,0,0,8"
                                           Foreground="#1E1E1E" 
                                           FontSize="14"
                                           LineHeight="18" />
                                <TextBlock Text="{Binding CurrentStep}" 
                                           HorizontalAlignment="Left"
                                           Foreground="#1E1E1E" 
                                           FontSize="14"
                                           LineHeight="18" />
                            </StackPanel>
                            
                            <!-- Ingredient Addition Progress -->
                            <StackPanel Margin="0,0,0,8">
                                <TextBlock Text="Ingredient Addition Progress:" 
                                           Margin="0,0,0,8"
                                           Foreground="#1E1E1E" 
                                           FontSize="14"
                                           LineHeight="18" />
                                <ProgressBar Value="{Binding IngredientAdditionProgress}" 
                                             Maximum="100" 
                                             Height="20" 
                                             HorizontalAlignment="Stretch" />
                    </StackPanel>
                            
                            <!-- Mix Time Progress -->
                            <StackPanel Margin="0,0,0,8">
                                <TextBlock Text="Mix Time Progress:" 
                                           Margin="0,0,0,8"
                                           Foreground="#1E1E1E" 
                                           FontSize="14"
                                           LineHeight="18" />
                                <ProgressBar Value="{Binding MixTimeProgress}" 
                                             Maximum="100" 
                                             Height="20" 
                                             HorizontalAlignment="Stretch" />
                            </StackPanel>
                            
                            <!-- Mix Time Remaining -->
                            <StackPanel Margin="0,0,0,0">
                                <TextBlock Text="Mix Time Remaining:" 
                                           Margin="0,0,0,8"
                                           Foreground="#1E1E1E" 
                                           FontSize="14"
                                           LineHeight="18" />
                                <Border BorderThickness="1" 
                                        BorderBrush="#E0E0E0" 
                                        Padding="12,8" 
                                        Margin="0,0,0,0"
                                        Background="White"
                                        CornerRadius="4">
                                    <TextBlock Text="{Binding MixTimeRemaining}" 
                                               HorizontalAlignment="Left"
                                               Foreground="#1E1E1E" 
                                               FontSize="14"
                                               LineHeight="18" />
                                </Border>
                            </StackPanel>
                    </StackPanel>
                    </Border>

                <!-- Process History -->
                    <Border Grid.Row="2" 
                            BorderThickness="1" 
                            BorderBrush="#E0E0E0" 
                            CornerRadius="6" 
                            Margin="0,0,0,16"
                            Background="White">
                        <StackPanel Margin="16">
                            <TextBlock Text="Process History" 
                                       FontWeight="SemiBold" 
                                       FontSize="14" 
                                       HorizontalAlignment="Center" 
                                       Margin="0,0,0,16" 
                                       Foreground="#0078D4" 
                                       LineHeight="18" />
                            
                            <ScrollViewer Height="100">
                                <TextBlock Text="{Binding ProcessHistory}" 
                                           TextWrapping="Wrap"
                                           Foreground="#1E1E1E" 
                                           FontSize="14"
                                           LineHeight="18" />
                            </ScrollViewer>
                    </StackPanel>
                    </Border>
            </Grid>
            </Border>
        </Grid>

        <!-- Footer Control Bar -->
        <Border Grid.Row="1" 
                BorderThickness="0,1,0,0" 
                BorderBrush="#E0E0E0" 
                Background="White"
                Padding="24,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1*" />
                    <ColumnDefinition Width="2*" />
                    <ColumnDefinition Width="1*" />
                </Grid.ColumnDefinitions>
                
                <!-- Left side - System Status -->
                <StackPanel Grid.Column="0" 
                            Orientation="Horizontal" 
                            VerticalAlignment="Center">
                    <Ellipse Width="12" 
                             Height="12" 
                             Fill="{Binding PlcStatusBrush}"
                             VerticalAlignment="Center" />
                    <TextBlock Text="{Binding PlcStatusText}" 
                               Margin="8,0,0,0"
                               VerticalAlignment="Center"
                               Foreground="#1E1E1E"
                               FontSize="14"
                               LineHeight="18" />
                </StackPanel>
                
                <!-- Middle - Centered buttons -->
                <StackPanel Grid.Column="1" 
                            Orientation="Horizontal" 
                            HorizontalAlignment="Center">
                    <Button x:Name="ProcessToggleButton"
                            Content="PAUSE PROCESS" 
                            Width="160"
                            Height="40"
                            Margin="0,0,16,0"
                            Style="{StaticResource PauseButtonStyle}"
                            Click="ProcessToggleButton_Click" />
                    
                    <Button Content="EMERGENCY STOP" 
                            Width="140"
                            Height="40"
                            Style="{StaticResource EmergencyButtonStyle}" />
        </StackPanel>
                
                <!-- Right side - Close button -->
                <Button Grid.Column="2" 
                        Content="CLOSE" 
                        Width="120"
                        Height="40"
                        HorizontalAlignment="Right"
                        Style="{StaticResource CloseButtonStyle}"
                        Click="Close_Click" />
            </Grid>
        </Border>
    </Grid>
</UserControl>
